<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Von Weber&#39;s Blog</title>
	<link rel="stylesheet" href="/css/style.css">
	
      <link rel="alternate" href="/atom.xml" title="Von Weber&#39;s Blog" type="application/atom+xml">
	
	
	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script>

</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/archives" class="header__link">Archive</a>
			
				<a href="/tags" class="header__link">Tags</a>
			
				<a href="/atom.xml" class="header__link">RSS</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Von Weber&#39;s Blog</a></h1>
		<h2 class="header__subtitle">No models are correct, but some are more elegant than others.</h2>
	</header>

	<main>
		



	<article>
	
		<h1><a href="/2018/11/23/Saddlepoint-Approximation/">Saddlepoint Approximation</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2018-11-23</span><br>
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/ç§¯åˆ†è®¡ç®—/">ç§¯åˆ†è®¡ç®—</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡/">ç»Ÿè®¡</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡è®¡ç®—/">ç»Ÿè®¡è®¡ç®—</a>
			</span>
		
	</div>

	

	
		<p>å’ŒEdgeworthå±•å¼€ç›¸æ¯”ï¼Œéç‚¹è¿‘ä¼¼æ˜¯æ›´åŠ ç²¾ç»†çš„åˆ†å¸ƒè¿‘ä¼¼æ–¹æ³•ï¼Œéç‚¹è¿‘ä¼¼åŒæ—¶é€‚ç”¨äºè¿ç»­å’Œç¦»æ•£çš„åˆ†å¸ƒã€‚åœ¨è®¸å¤šæç«¯çš„æ¡ä»¶ä¸‹ï¼Œéç‚¹è¿‘ä¼¼éƒ½è¡¨ç°å‡ºæƒŠäººçš„ç²¾åº¦ã€‚éç‚¹è¿‘ä¼¼æœ‰è®¸å¤šè§’åº¦çš„ç†è§£ï¼Œç„¶è€Œä¸‹é¢çš„æ¨å¯¼å±•ç¤ºäº†éç‚¹è¿‘ä¼¼å’ŒEdgeworthçš„å…³ç³»ï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆå…·æœ‰é«˜ç²¾åº¦ã€‚</p>
<h2 id="Tilted-Exponential-Families"><a href="#Tilted-Exponential-Families" class="headerlink" title="Tilted Exponential Families"></a>Tilted Exponential Families</h2><p>è®¾ $f(x)$ æ˜¯ä¸€ä¸ªå¯†åº¦å‡½æ•°ï¼Œåœ¨åŒºé—´ $(a,b)$ å…·æœ‰çŸ©æ¯å‡½æ•° $M(s) = E e^{sX} $ å’Œç´¯é‡æ¯å‡½æ•° $ K(s) = \log M(s) $ã€‚åˆ™ä¸‹åˆ—æŒ‡æ•°åˆ†å¸ƒæ—ç§°ä¸º tilted æ­£åˆ™æŒ‡æ•°æ— $$ f(x;s) = \exp \{ sx - K(s) \} f(x), \qquad s \in (a,b) $$<br>$f(x;s)$ ç§°ä½œ s-tilted å¯†åº¦ï¼Œç”¨ $X_s$ è¡¨ç¤ºæœä»æ­¤å¯†åº¦çš„ä¸€ä¸ªéšæœºå˜é‡ã€‚å®¹æ˜“æ¨å¯¼ $X_s$ çš„ å‡å€¼å’Œæ–¹å·®æ»¡è¶³<br>$$ E(X_s) = Kâ€™(s)$$ $$ Var(X_s) = Kâ€™â€™(s)$$<br>ä»¥åŠ $X_s$ çš„é«˜é˜¶æ ‡å‡†åŒ–ç´¯é‡<br>$$ \kappa_i(s) = E \left( {X_s -\mu_s \over \sigma_s} \right)^i =<br>{K^{(i)}(s) \over \{ Kâ€™â€™(s) \}^{i/2} }, \qquad i \geq 3 $$</p>
<h2 id="Saddlepoint-Approximation"><a href="#Saddlepoint-Approximation" class="headerlink" title="Saddlepoint Approximation"></a>Saddlepoint Approximation</h2><p>ç”± tilted æŒ‡æ•°æ—å®šä¹‰å¯çŸ¥<br>$$ f(x) \equiv \exp \{ K(s) -sx \} f(x;s), \qquad \forall s \in (a,b) $$<br>æ³¨æ„è¿™é‡Œæ˜¯å¯¹ä»»æ„çš„ sï¼Œä¸¤è¾¹éƒ½æ˜¯ä¸€æ ·çš„å¯†åº¦å‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒçš„ xï¼Œé€‰æ‹©ä¸åŒçš„ sï¼Œä½¿è¿‘ä¼¼æ•ˆæœè¾¾åˆ°æœ€ä½³ã€‚</p>
<p>è€ƒè™‘ $ f(x;s) $ çš„Edgeworth å±•å¼€<br>$$ f(x;s) = \phi \left( {x -\mu_s \over \sigma_s} \right) \left\{ 1 + {\kappa_{3}(s) \over 6 }  \left[ \left( {x -\mu_s \over \sigma_s} \right)^3 - 3 \left( {x -\mu_s \over \sigma_s} \right)  \right] + O \left( {1 \over n} \right) \right\} $$<br>å¯¹äºå›ºå®šçš„ xï¼Œè‹¥é€‰æ‹©sï¼Œä½¿å¾— $\mu_s =x$ï¼Œåˆ™åœ¨xç‚¹ä¸Šçš„è¿‘ä¼¼å…·æœ‰ $O(1/n)$ çš„ç²¾åº¦ã€‚ç°åœ¨å¯¹ä¸åŒçš„xï¼Œæˆ‘ä»¬å§‹ç»ˆé€‰æ‹© $\hat s$ æ»¡è¶³<br>$$  Kâ€™(\hat s(x)) = x $$<br>ä»è€Œå¯ä»¥ä½¿ $o(1/n)$ çš„ç²¾åº¦æ˜¯å…¨å±€çš„ã€‚ä¸Šé¢çš„æ–¹ç¨‹è¢«ç§°ä½œéç‚¹æ–¹ç¨‹ã€‚å°† $ f(x;s) $ çš„è¿‘ä¼¼å¸¦å…¥åˆ° $ f(x) $ ä¸­<br>$$ f(x) \approx {1 \over \sqrt{2 \pi Kâ€™â€™(\hat s (x)) }} \exp \{ K(\hat s(x)) -\hat s(x)x \} $$<br>ä¸Šå¼ç§°ä¸º $ f(x) $ çš„ï¼ˆä¸€é˜¶ï¼‰éç‚¹è¿‘ä¼¼ã€‚</p>
<h2 id="è¿ç»­åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼"><a href="#è¿ç»­åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼" class="headerlink" title="è¿ç»­åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼"></a>è¿ç»­åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼</h2><p>è®¾ $X_i, i \in \Bbb{N}$ æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„è¿ç»­éšæœºå˜é‡ï¼Œå…·æœ‰ç´¯é‡æ¯å‡½æ•° $K(s)$ã€‚åˆ™å‡å€¼ $ \bar X =\sum_{i=1}^n X_i$ å¯†åº¦å‡½æ•°çš„éç‚¹è¿‘ä¼¼ä¸º<br>$$ \hat f _{\bar X}(x)  = \sqrt{ { n \over 2 \pi Kâ€™â€™(\hat s (x)) } } \exp \{ K( \hat s(x)) -\hat s(x)x \} $$</p>
<p>$X$ åˆ†å¸ƒçš„å‡½æ•°çš„éç‚¹è¿‘ä¼¼ä¸º<br>$$ \hat F_{\bar X}(x) = \begin{cases}<br>    \Phi(\hat w) + \phi(\hat w) \left( {1 \over \hat w} - {1 \over \hat u} \right) &amp; \text{if  }x \neq \mu \\<br>    {1 \over 2} + { Kâ€™â€™â€™(0) \over 6 \sqrt{2} \pi Kâ€™â€™(0)^{3/2} } &amp; \text{if  }x = \mu<br>\end{cases} $$<br>å…¶ä¸­<br>$$\begin{align}<br>\hat w &amp;= \text{sgn}(\hat s) \sqrt{ 2 \{ \hat s x -K(\hat s) \} } \\<br>\hat u &amp;= \hat s \sqrt{ Kâ€™â€™(\hat s) }<br>\end{align} $$<br>$\Phi(\cdot),\phi(\cdot) $ åˆ†åˆ«ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„åˆ†å¸ƒå’Œæ¡‰æ ‘å’Œå¯†åº¦å‡½æ•°ï¼Œ$\hat s$ æ˜¯éç‚¹æ–¹ç¨‹ $Kâ€™(s) =x $ çš„è§£ã€‚</p>
<h2 id="ç¦»æ•£åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼"><a href="#ç¦»æ•£åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼" class="headerlink" title="ç¦»æ•£åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼"></a>ç¦»æ•£åˆ†å¸ƒçš„éç‚¹è¿‘ä¼¼</h2><p>è®¾ $X$ æ˜¯æ•´æ•° $\Bbb{Z}$ ä¸Šçš„éšæœºå˜é‡ï¼Œ $p(k)$ æ˜¯å…¶è´¨é‡å‡½æ•°ï¼Œåˆ™ $p(k) $ å…·æœ‰éç‚¹è¿‘ä¼¼<br>$$ \hat p(k) = {1 \over \sqrt{ 2 \pi Kâ€™â€™(\hat s) }} \exp \{  K(\hat s) - \hat s k  \} $$<br>å…¶ä¸­ $\hat s$ æ˜¯éç‚¹æ–¹ç¨‹ $Kâ€™(\hat s) = k, \quad k \in \mathcal{I_X}  $ï¼Œ $\mathcal{I_X}  $ æ˜¯ supp X å»¶å±•çš„å†…ç‚¹é›†ã€‚</p>
<p>å®šä¹‰ $ k^- =k-1/2 \in \mathcal{I_X} $ æ˜¯ kçš„åç½®ï¼Œ$\hat s$ æ˜¯éç‚¹æ–¹ç¨‹ $Kâ€™(\hat s) = k^-$ çš„è§£ï¼Œåˆ™$X$ ç”Ÿå­˜å‡½æ•°çš„ï¼ˆç¬¬äºŒè¿ç»­æ€§çŸ«æ­£ï¼‰éç‚¹è¿‘ä¼¼ä¸º<br>$$ \hat{Pr}(X \geq k) = \begin{cases}<br>    1 - \Phi(\hat w) - \phi(w)(1/2 - 1/u) &amp; \text{if } k^- \neq \mu \\<br>    1/2 - { Kâ€™â€™â€™(0) \over 6 \sqrt{2} Kâ€™â€™(0)^{3/2} } &amp; \text{if  } k^- = \mu<br>\end{cases}  $$<br>å…¶ä¸­<br>$$\begin{align}<br>    \hat w &amp;= \text{sgn}(\hat s) \sqrt{2 \{ \hat s k^- -K(\hat s)  \}} \\<br>    \hat u &amp;= 2 \text{sinh}(\hat s/2) \sqrt{Kâ€™â€™(\hat s)}<br>\end{align}$$</p>

	

	

</article>




	<article>
	
		<h1><a href="/2018/11/22/Edgeworth-Expansion/">Edgeworth Expansion</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2018-11-22</span><br>
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/ç§¯åˆ†è®¡ç®—/">ç§¯åˆ†è®¡ç®—</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡/">ç»Ÿè®¡</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡è®¡ç®—/">ç»Ÿè®¡è®¡ç®—</a>
			</span>
		
	</div>

	

	
		<p>è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„éšæœºå˜é‡ $X$ å…·æœ‰å¤æ‚çš„ç»“æ„ï¼Œæˆ‘ä»¬æ— æ³•æˆ–è€…å¾ˆéš¾å¾—åˆ°å®ƒçš„ç²¾ç¡®åˆ†å¸ƒå¯†åº¦PDFæˆ–åˆ†å¸ƒå‡½æ•°CDFï¼Œå¯¹äº $X$ çš„ç ”ç©¶æ¯”å¦‚æ±‚æ¦‚ç‡ $P(X \in A)$ å°±å˜å¾—ä¸é‚£ä¹ˆç›´æ¥ã€‚å¤šæ•°æƒ…å†µä¸‹ï¼Œ$X$ å¯ä»¥è¡¨ç¤ºä¸ºä¸€äº›ç‹¬ç«‹ç”šè‡³åŒåˆ†å¸ƒéšæœºå˜é‡çš„å’Œï¼ˆå‡å€¼ï¼‰ã€‚å¯¹äºå¹³å‡¡çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸­å¿ƒæé™å®šç†CLTå°† $X$ çš„åˆ†å¸ƒè¿‘ä¼¼ä¸ºæ­£æ€åˆ†å¸ƒã€‚ç„¶è€Œå¯¹äºä¸€äº›é—®é¢˜æ¯”å¦‚</p>
<ul>
<li>$\bar X={1 \over n} \sum_{i=1}^n X_i$ï¼Œnå¾ˆå°åªæœ‰å‡ æˆ–è€…å‡ å</li>
<li>$P(\bar X \in A)$ å¾ˆå°æ¯”å¦‚ $P(\sqrt{n}|\bar X -\mu| &gt; 4\sigma)$ </li>
</ul>
<p>æ­¤æ—¶æ­£æ€åˆ†å¸ƒçš„è¿‘ä¼¼å°±å¾ˆå·®ã€‚è€ŒEdgeworthå±•å¼€ä½œä¸ºä¸­å¿ƒæé™å®šç†çš„è‡ªç„¶å»¶ä¼¸ï¼Œä»ä¸€å®šç¨‹åº¦ä¸Šæ”¹å–„äº†è¿‘ä¼¼çš„æ•ˆæœ</p>
<h2 id="Tchebycheffâ€“Hermite-Polynomials"><a href="#Tchebycheffâ€“Hermite-Polynomials" class="headerlink" title="Tchebycheffâ€“Hermite Polynomials"></a>Tchebycheffâ€“Hermite Polynomials</h2><p>è®¾ $\phi(z)$ æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒ $N(0,1)$ çš„å¯†åº¦å‡½æ•°ï¼Œç”±å½’çº³æ³•å®¹æ˜“è¯æ˜ï¼Œå­˜åœ¨å¤šé¡¹å¼ $ \{H(z) \}_k$ æˆç«‹<br>$${ d^k \over dz^k} \phi (z) = (-1)^k H_k(z) \phi (z) $$<br>å…¶ä¸­ $\{ H_k(z): k \in \Bbb{N} \}$ ç§°ä¸ºTchebycheffâ€“Hermiteå¤šé¡¹å¼ã€‚å¯¹ä¸Šå¼æ±‚å¯¼ï¼Œå¾—åˆ°<br>$${d \over dx} [ H_k(z)\phi(z) ]=-H_{k+1}(z)\phi(z) $$<br>ç”±æ­¤å¯ä»¥é€’æ¨å‡º $H_k(z)$ï¼Œå‰å‡ é¡¹ä¸º<br>$$\begin{align}<br>    H_0(z) &amp;=1 &amp; H_3(z)&amp;= z^3 âˆ’ 3z  \\<br>    H_1 (z) &amp;= z  &amp; H_4 (z) &amp;= z^4 âˆ’ 6z^2 + 3 \\<br>    H_2 (z) &amp;= z^2 âˆ’ 1 &amp; H_5 (z) &amp;= z^5 âˆ’ 10z^3 + 15z<br>\end{align}$$</p>
<p>$\{ H_k(z): k \in \Bbb{N} \}$ æ˜¯æ­£äº¤å¤šé¡¹å¼ï¼Œåœ¨å¦‚ä¸‹çš„åŠ æƒå…§ç§¯æ„ä¹‰ä¸‹<br>$$&lt;H_i(z), H_j(z)&gt; = \int_{\Bbb{R} }H_i (z) H_j (z)\phi (z)dz=<br>\begin{cases}<br>    0 &amp; \text{if }i\neq j \\<br>    i! &amp; \text{if } i=j<br>\end{cases}$$</p>
<h2 id="Inverse-Fourier-Transform"><a href="#Inverse-Fourier-Transform" class="headerlink" title="Inverse Fourier Transform"></a>Inverse Fourier Transform</h2><p>è®¾ $X \sim g(x)$ å…·æœ‰ç‰¹å¾å‡½æ•° $h(u)$ï¼Œåˆ™ $h(u)$ å…·æœ‰é€†å˜æ¢<br>$$g(x)={1 \over 2\pi } \int_{\Bbb{R}} e^{-iux} h(u)du$$<br>ç‰¹åˆ«åœ°ï¼Œç”±Fourierå˜æ¢çš„æ€§è´¨ï¼Œæˆç«‹<br>$$\begin{align}<br>{1 \over 2\pi } \int_{\Bbb{R}} e^{-iux} e^{-u^2/2} (iu)^k du<br>&amp;= {(-1)^k \over 2 \pi} {d^k \over dx^k} \int_{\Bbb{R}} e^{-iux} e^{-u^2/2}du \\<br>&amp;= (-1)^k {d^k \over dx^k} \phi(x) \\<br>&amp;= H_k(x)\phi(x)<br>\end{align}$$<br>ä¹Ÿå°±æ˜¯è¯´è‹¥ $X$ å…·æœ‰ç‰¹å¾å‡½æ•° $e^{-u^2/2} (iu)^k$ï¼Œåˆ™ $X$ å…·æœ‰å¯†åº¦å‡½æ•° $H_k(x)\phi(x)$ã€‚</p>
<h2 id="Edgeworth-Expansion-çš„æ¨å¯¼"><a href="#Edgeworth-Expansion-çš„æ¨å¯¼" class="headerlink" title="Edgeworth Expansion çš„æ¨å¯¼"></a>Edgeworth Expansion çš„æ¨å¯¼</h2><p>è®¾ $X_i$ æœ‰å‡å€¼0æ–¹å·®1ï¼Œæœ‰æœ‰é™å››é˜¶çŸ©ï¼Œè®° $\gamma=E X_j^3, \tau=E X_j^4$ã€‚ç°åœ¨è€ƒè™‘æ­£è§„åŒ–å‡å€¼ $S_n = \sqrt{n} \bar X$ çš„ç‰¹å¾å‡½æ•°ã€‚<br>$$h_{S_n} (u)=E \exp \{ ( iu/ \sqrt{n} ) \sum X_j \} =[ h_X(u/\sqrt{n}) ]^n$$<br>å¯¹ $\exp \{ iuX/\sqrt{n} \}$ ä½œæ³°å‹’å±•å¼€å¾—åˆ°<br>$$h_X \left( {u \over \sqrt{n}} \right) = E e^ { iu {X \over \sqrt{n}} }<br>= \left( 1- {u^2 \over 2n} \right) +<br>{(iu)^3 \gamma \over 6n \sqrt{n} } +<br>{(iu)^4 \tau \over 24n^2 } +<br>o \left( {1 \over n^2} \right)$$<br>ä¸¤è¾¹å–næ¬¡å¹‚ï¼Œå†ç”±äºŒé¡¹å±•å¼€å¼å’Œ<br>$$ \left( 1+ {a \over n} \right) ^{n-k} =<br>e^a \left( 1- {a(a+k) \over 2n} \right) +<br>o \left( {1 \over n} \right)$$<br>å¾—åˆ°<br>$$h_{S_n}(u) = e^{-u^2/2} \left[ 1 +<br>{(iu)^3 \gamma \over 6 \sqrt{n} } +<br>{(iu)^4 ( \tau -3) \over 24n } +<br>{(iu)^6 \gamma^2 \over 72n} \right] +<br>o \left( {1 \over n} \right)$$<br>æœ€åç”±ä¸Šè¿°å…³äºç‰¹å¾å‡½æ•°å’Œå¯†åº¦å‡½æ•°çš„é€†å˜æ¢ï¼Œå¾—åˆ° $S_n$ çš„å¯†åº¦å‡½æ•°ä¸º<br>$$\begin{align}<br>g_{S_n}(x) &amp;= {1 \over 2\pi } \int_{\Bbb{R}} e^{-iux} h_{S_n}(u) du \\<br>&amp;= \phi(x) \left( 1+<br>{1 \over \sqrt{n}} {\gamma H_3(x) \over 6} +<br>{1 \over n} \left[ {(\tau-3) H_4(x) \over 24} +<br>{\gamma^2 H_5(x) \over 72} \right] \right) +<br>o \left( {1 \over n} \right)<br>\end{align}$$<br>ä¸¤è¾¹æ±‚ç§¯åˆ†ï¼Œåˆ©ç”¨ä¸Šé¢ $H_k(x) \phi(x)$ çš„é€’æ¨å…³ç³»å¾—åˆ° $S_n$ åˆ†å¸ƒå‡½æ•°çš„è¿‘ä¼¼<br>$$G_{S_n}(x)=<br>\Phi(x) - \phi(x) \left(<br>{1 \over \sqrt{n}} {\gamma H_2(x) \over 6} +<br>{1 \over n} \left[ {(\tau-3) H_3(x) \over 24} +<br>{\gamma^2 H_4(x) \over 72} \right] \right) +<br>o \left( {1 \over n} \right)<br>$$<br>åŒ…å«ä¸Šè¿° $1/\sqrt{n}$ å’Œ $ 1/n$ çš„è¿‘ä¼¼ï¼Œåˆ†åˆ«å«åšEdgeworthä¸€é˜¶/äºŒé˜¶å±•å¼€ã€‚</p>
<p>æ­¤å¤–å€¼å¾—ä¸€æçš„æ˜¯</p>
<ul>
<li>è‹¥ $X_i$ å…·æœ‰å¯¹ç§°åˆ†å¸ƒï¼Œä¸‰é˜¶çŸ© $\gamma=0$ï¼Œé€šå¸¸çš„æ­£æ€åˆ†å¸ƒè¿‘ä¼¼å·²ç»å…·æœ‰ä¸€é˜¶Edgeworthè¿‘ä¼¼çš„ç²¾åº¦ï¼Œ</li>
<li>$g_{S_n}(x)$ åœ¨0ç‚¹ï¼ˆéæ­£è§„åŒ–çš„éšæœºå˜é‡åœ¨å‡å€¼ $\mu$ ç‚¹ï¼‰ï¼Œç”±äºå¥‡æ•°Hermiteå¤šé¡¹å¼åœ¨0ç‚¹ä¸º0ï¼Œå³ $H_3(0)=0$ï¼Œæ•…ä¸€é˜¶Edgeworthè¿‘ä¼¼å…·æœ‰ $O(1/n)$ çš„ç²¾åº¦ï¼Œ</li>
<li>Edgeworthå±•å¼€å¹¶æœªè¿›è¡Œæ¦‚ç‡æ„ä¹‰ä¸Šçš„è§„çº¦ï¼Œæ‰€ä»¥è®¡ç®—ç»“æœå¯èƒ½è¶…å‡º $[0,1]$ ä¹‹å¤–ã€‚</li>
<li>é«˜é˜¶çš„Edgeworthå±•å¼€è™½ç„¶å…·æœ‰ç†è®ºä¸Šçš„é«˜é˜¶æ¸è¿›ç²¾åº¦ï¼Œä½†ä¹Ÿå®¹æ˜“çŸ«æ‰è¿‡æ­£ï¼Œä½¿ç»“æœä¸å¯é ï¼Œå› è€Œä»…å…·æœ‰ç†è®ºæ„ä¹‰ã€‚</li>
</ul>
<h2 id="æŒ‡æ•°åˆ†å¸ƒçš„å’Œ"><a href="#æŒ‡æ•°åˆ†å¸ƒçš„å’Œ" class="headerlink" title="æŒ‡æ•°åˆ†å¸ƒçš„å’Œ"></a>æŒ‡æ•°åˆ†å¸ƒçš„å’Œ</h2><p>è®¾ $X_i \sim \text{Exp}(1),i=1,â€¦,5$ åˆ™ $\mu = \sigma^2=1, E(X_i-\mu)^3/\sigma^3 = 2, E(X_i-\mu)^4/\sigma^4 = 6$ã€‚ç°åœ¨è€ƒè™‘ $X_i$ çš„æ­£è§„åŒ–å’Œ $S_n = \sqrt{n} (\bar X -\mu)$ çš„åˆ†å¸ƒï¼Œç”±äº $\sum X_i \sim \Gamma(5,1)$ï¼Œæˆ‘ä»¬å¯ä»¥å‡†ç¡®çŸ¥é“ $S_n$ çš„åˆ†å¸ƒã€‚ä¸‹é¢çš„ä»£ç å’Œå›¾1å±•ç¤ºäº†æ­£æ€åˆ†å¸ƒå’ŒEdgeworthè¿‘ä¼¼çš„æ•ˆæœã€‚</p>
<pre><code class="R">n = <span class="number">5</span>
b1 = <span class="number">2</span>
b2 = <span class="number">6</span>
H3 = <span class="keyword">function</span>(x) (x ^ <span class="number">3</span> - <span class="number">3</span> * x)
H4 = <span class="keyword">function</span>(x) (x ^ <span class="number">4</span> - <span class="number">6</span> * x ^ <span class="number">2</span> + <span class="number">3</span>)
H6 = <span class="keyword">function</span>(x)  (x ^ <span class="number">6</span> - <span class="number">15</span> * x ^ <span class="number">4</span> + <span class="number">45</span> * x ^ <span class="number">2</span> - <span class="number">15</span>)

f1 = <span class="keyword">function</span>(x) {
  dnorm(x) * (<span class="number">1</span> + b1 * H3(x) / <span class="number">6</span> / sqrt(n))
}

f2 = <span class="keyword">function</span>(x) {
  f1(x) + (b2 * H4(x) / <span class="number">24</span> / n + b1 ^ <span class="number">2</span> * H6(x) / <span class="number">72</span> / n) * dnorm(x)
}
x = seq(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">0.01</span>)
fn_true = dgamma((x + sqrt(n)) * sqrt(n), n, <span class="number">1</span>) * sqrt(n)
fn_E0 = dnorm(x)
fn_E1 = f1(x)
fn_E2 = f2(x)
label = c(<span class="string">'Exact'</span>,
          <span class="string">'Normal'</span>,
          <span class="string">'First-order Edgeworth'</span>,
          <span class="string">'Second-order Edgeworth'</span>)
data = data.frame(
  density = c(fn_true, fn_E0, fn_E1, fn_E2),
  x = rep(x, <span class="number">4</span>),
  estimate = rep(label, each = length(x))
)
ggplot(data, aes(x, density, color = estimate)) +
  scale_colour_manual(breaks = label,
                      values = c(<span class="string">'#000000'</span>, <span class="string">'#1b9e77'</span>,  <span class="string">'#d95f02'</span>, <span class="string">'#7570b3'</span>)) +
  theme(legend.position = c(<span class="number">0.85</span>, <span class="number">0.82</span>)) +
  geom_line()
</code></pre>
<p><figure class="figure"><img src="/img/Edgeworth-1.svg" alt="å›¾1. æŒ‡æ•°åˆ†å¸ƒå’Œçš„Edgeworthè¿‘ä¼¼"><figcaption class="figure__caption">å›¾1. æŒ‡æ•°åˆ†å¸ƒå’Œçš„Edgeworthè¿‘ä¼¼</figcaption></figure></p>
<p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡º</p>
<ul>
<li>æ­£æ€åˆ†å¸ƒçš„è¿‘ä¼¼æ•ˆæœæå·®ï¼Œç”±äºæ ·æœ¬é‡å¤ªå°ï¼Œæ— æ³•çº æ­£æŒ‡æ•°åˆ†å¸ƒçš„ååº¦</li>
<li>Edgeworthè¿‘ä¼¼åœ¨åˆ†å¸ƒçš„ä¸»ä½“éƒ¨åˆ†æœ‰ä¸é”™çš„è¿‘ä¼¼æ•ˆæœ</li>
<li>åœ¨åˆ†å¸ƒçš„å°¾éƒ¨ï¼ŒEdgeworthçš„æ•ˆæœçš„ä»ä¸å¥½ï¼Œç”šè‡³åœ¨å·¦å°¾å‡ºç°äº†è´Ÿå€¼</li>
</ul>
<p>ä¸‹é¢çš„è¡¨æ ¼å±•ç¤ºäº†ä¸€äº›åŒºé—´æ¦‚ç‡çš„ä¼°è®¡ï¼Œå°è¯äº†ä¸Šé¢çš„è®ºæ–­</p>
<table>
<thead>
<tr>
<th>$(a,b)$</th>
<th>æ­£æ€åˆ†å¸ƒ</th>
<th>ä¸€é˜¶Edgeworthè¿‘ä¼¼</th>
<th>äºŒé˜¶Edgeworthè¿‘ä¼¼</th>
<th>ç²¾ç¡®å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(-\infty,-2.0)$</td>
<td>0.023</td>
<td>-0.001</td>
<td>-0.007</td>
<td>0.000</td>
</tr>
<tr>
<td>$(-\infty,-1.8)$</td>
<td>0.036</td>
<td>0.010</td>
<td>0.000</td>
<td>0.003</td>
</tr>
<tr>
<td>$(-\infty,-1.6)$</td>
<td>0.055</td>
<td>0.029</td>
<td>0.017</td>
<td>0.015</td>
</tr>
<tr>
<td>$(-0.2ï¼Œ0.2)$</td>
<td>0.158</td>
<td>0.158</td>
<td>0.156</td>
<td>0.156</td>
</tr>
<tr>
<td>$(-1.0,1.0)$</td>
<td>0.682</td>
<td>0.682</td>
<td>0.698</td>
<td>0.700</td>
</tr>
<tr>
<td>$(1.8,\infty)$</td>
<td>0.036</td>
<td>0.062</td>
<td>0.053</td>
<td>0.054</td>
</tr>
<tr>
<td>$(2.0,\infty)$</td>
<td>0.023</td>
<td>0.047</td>
<td>0.041</td>
<td>0.041</td>
</tr>
</tbody>
</table>

	

	

</article>




	<article>
	
		<h1><a href="/2018/11/20/Laplace-Approximation/">Laplace Approximation</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2018-11-20</span><br>
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/ç§¯åˆ†è®¡ç®—/">ç§¯åˆ†è®¡ç®—</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡/">ç»Ÿè®¡</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡è®¡ç®—/">ç»Ÿè®¡è®¡ç®—</a>
			</span>
		
	</div>

	

	
		<p>ç»Ÿè®¡ä¸­çš„è®¡ç®—é—®é¢˜å¤§è‡´å¯ä»¥åˆ†æˆä¸¤ç±»ï¼Œç§¯åˆ†é—®é¢˜å’Œæœ€ä¼˜åŒ–é—®é¢˜ï¼Œç§¯åˆ†é—®é¢˜å¸¸å¸¸å’ŒBayesæ–¹æ³•æœ‰å…³ï¼Œæœ€ä¼˜åŒ–é—®é¢˜å¸¸å¸¸å’Œä¼¼ç„¶æ–¹æ³•ç›¸å…³ã€‚æ±‚ç§¯åˆ†çš„æ–¹æ³•ï¼Œé™¤äº†åŸºäºæ¨¡æ‹Ÿçš„Monte Carloæ–¹æ³•å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›åŸºäºåˆ†æçš„æ–¹æ³•åœ¨ç»Ÿè®¡ä¸­å¸¸è§ï¼Œå…¶ä¸­æœ€å¤è€ä¹Ÿæœ€æœ‰ç”¨çš„æ–¹æ³•å°±æ˜¯Laplaceè¿‘ä¼¼ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æ„Ÿå…´è¶£çš„ç§¯åˆ†é—®é¢˜æ˜¯<br>$$\int_A f(x|\theta) dx$$<br>å…¶ä¸­ $f$ æ˜¯éè´Ÿå¯ç§¯å‡½æ•°ï¼Œ$\theta$ æ˜¯å›ºå®šçš„å‚æ•°ã€‚</p>
<p>å°†è¢«ç§¯å‡½æ•°å†™ä½œ $f(x|\theta)=\exp \{ nh(x|\theta) \}$ï¼Œå…¶ä¸­næ˜¯æ ·æœ¬å¤§å°æˆ–è€…æŸä¸ªå¯ä»¥è¶‹è¿‘æ— ç©·å¤§çš„å‚æ•°ï¼Œå¯¹ $h(x|\theta)$ åœ¨ $x_0$ ç‚¹ä½œTaylorå±•å¼€ï¼Œå¾—åˆ°<br>$$h(x|\theta) =<br>h(x_0|\theta)+(x-x_0)hâ€™(x_0|\theta)+{(x-x_0)^2 \over 2!} hâ€™â€™(x_0|\theta)+<br>{(x-x_0)^3 \over 3!} hâ€™â€™â€™(x_0|\theta) + R_n(x)$$<br>å…¶ä¸­ $R_n(x) = o((x-x_0)^3), x \to x_0.$</p>
<p>ç°åœ¨é€‰æ‹© $x_0=\hat x_{\theta}$ï¼Œæ»¡è¶³ $hâ€™(x_0|\theta)=0$ ä¸”æœ€å¤§åŒ– $h(x|\theta)$ã€‚åœ¨ $\hat x_{\theta}$ çš„æŸä¸ªé‚»åŸŸæˆç«‹<br>$$\int_A e^{nh(x|\theta)} dx \approx e^{nh(\hat x_{\theta}|\theta)} \int_A<br>e^{n {(x-x_0)^2 \over 2!} hâ€™â€™(\hat x_{\theta}|\theta)}<br>e^{n {(x-x_0)^3 \over 3!} hâ€™â€™â€™(\hat x_{\theta}|\theta)}$$<br>å¯¹äºä¸‰é˜¶å¯¼é¡¹ï¼Œè‹¥è€ƒè™‘æŒ‡æ•°å±•å¼€ $e^y \approx 1+y+y^2/{2!}$ ï¼Œå¾—åˆ°è¿‘ä¼¼<br>$$e^{n {(x-x_0)^3 \over 3!} hâ€™â€™â€™(\hat x_{\theta}|\theta)} \approx<br>1+ n {(x-x_0)^3 \over 3!} hâ€™â€™â€™(\hat x_{\theta}|\theta)+<br>n^2 {(x-x_0)^6 \over {2! (3!)^2 }} [ hâ€™â€™â€™(\hat x_{\theta}|\theta) ]^2$$</p>
<p>å¸¦å›å»ï¼Œæˆ‘ä»¬å¾—åˆ°<br>$$\int_A e^{nh(x|\theta)} dx \approx<br>e^{nh(\hat x_{\theta}|\theta)} \int_A<br>e^{n {(x-x_0)^2 \over 2!} hâ€™â€™(\hat x_{\theta}|\theta)} \times<br>\left[ 1+ n {(x-x_0)^3 \over 3!} hâ€™â€™â€™(\hat x_{\theta}|\theta)+<br>n^2 {(x-x_0)^6 \over {2! (3!)^2 }} [ hâ€™â€™â€™(\hat x_{\theta}|\theta) ]^2 \right] dx$$<br>ä¸Šå¼æ–¹æ‹¬å·å†…åˆ†åˆ«å–å‰1/2/3é¡¹ï¼Œåˆ†åˆ«å«åšä¸€é˜¶/äºŒé˜¶/ä¸‰é˜¶Laplaceè¿‘ä¼¼ã€‚</p>
<p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºä¸€é˜¶è¿‘ä¼¼ï¼Œæ³¨æ„åˆ°å…¶å’Œæ­£æ€åˆ†å¸ƒå¯†åº¦çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è¡¨ç¤ºä¸º<br>$$\int_A e^{nh(x|\theta)} dx \approx<br>e^{nh(\hat x_{\theta}|\theta)}<br>\sqrt{2 \pi \over {-n hâ€™â€™(\hat x_{\theta}|\theta)}} \times<br>\left \{ \Phi [ \sqrt{-n hâ€™â€™(\hat x_{\theta}|\theta)} (b- \hat x_{\theta}) ] -<br>\Phi [ \sqrt{-n hâ€™â€™(\hat x_{\theta}|\theta)} (a- \hat x_{\theta}) ]\right \} $$<br>å…¶ä¸­ï¼Œå– $A=[ a,b ]$ï¼Œ$\Phi(\cdot)$ ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„cdfã€‚</p>
<p>ä»ä¸Šé¢çš„å½¢å¼å¯ä»¥çœ‹å‡ºï¼ŒLaplaceè¿‘ä¼¼çš„è®¡ç®—ä¸å­˜åœ¨æœ¬è´¨å›°éš¾ï¼Œä½†äºŒä¸‰é˜¶è¿‘ä¼¼çš„è®¡ç®—ç•¥æ˜¾ç¹çã€‚</p>
<h3 id="Gammaç§¯åˆ†çš„è¿‘ä¼¼"><a href="#Gammaç§¯åˆ†çš„è¿‘ä¼¼" class="headerlink" title="Gammaç§¯åˆ†çš„è¿‘ä¼¼"></a>Gammaç§¯åˆ†çš„è¿‘ä¼¼</h3><p>è‹¥ä»¥ä¸€ä¾‹æ¥è¯´æ˜Laplaceè¿‘ä¼¼çš„åŠŸæ•ˆï¼Œæˆ‘ä»¬è€ƒè™‘Gammaåˆ†å¸ƒ $\mathcal{G}a(\alpha, 1/ \beta)$ çš„ç§¯åˆ†<br>$$\int_a^b {x^{\alpha-1} \over {\Gamma (\alpha) \beta^\alpha}} e^{-x/ \beta} dx$$</p>
<p>ç•¥å»åˆ†æ¯çš„å¸¸æ•°ï¼Œé¦–å…ˆæ±‚å¾— $h(x) = - {x \over \beta} +(\alpha-1) \log(x)$ï¼Œä¸€äºŒä¸‰é˜¶å¯¼æ•°åˆ†åˆ«ä¸º<br>$$\begin{align}<br>    hâ€™(x) &amp;= {\alpha -1 \over x}- {1 \over \beta} \\<br>    hâ€™â€™(x) &amp;= - {\alpha-1 \over x^2} \\<br>    hâ€™â€™â€™(x) &amp;= {2(\alpha-1) \over x^3}<br>\end{align}$$<br>å¯¹äº $\alpha=5, \beta=2$ï¼Œé€‰å– $\hat x_\theta = (\alpha-1)\beta=8$ã€‚å¯¹äºä¸åŒçš„ç§¯åˆ†åŒºé—´ï¼Œè®¡ç®—Laplaceè¿‘ä¼¼ï¼Œå¾—åˆ°ä¸‹è¡¨</p>
<table>
<thead>
<tr>
<th>åŒºé—´</th>
<th>ä¸€é˜¶è¿‘ä¼¼</th>
<th>äºŒé˜¶è¿‘ä¼¼</th>
<th>ä¸‰é˜¶è¿‘ä¼¼</th>
<th>ç²¾ç¡®å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>(7,9)</td>
<td>0.193351</td>
<td>0.193351</td>
<td>0.193351</td>
<td>0.193341</td>
</tr>
<tr>
<td>(6,10)</td>
<td>0.375046</td>
<td>0.375046</td>
<td>0.375057</td>
<td>0.374770</td>
</tr>
<tr>
<td>(2,14)</td>
<td>0.848559</td>
<td>0.848559</td>
<td>0.859839</td>
<td>0.823349</td>
</tr>
<tr>
<td>(0,7)</td>
<td>0.370755</td>
<td>0.293452</td>
<td>0.315920</td>
<td>0.274555</td>
</tr>
<tr>
<td>(15.987,$\infty$)</td>
<td>0.022454</td>
<td>0.075564</td>
<td>0.155272</td>
<td>0.100005</td>
</tr>
</tbody>
</table>
<p>ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºä¸€èˆ¬çš„åŒ…å«çš„ $\hat x_\theta$ çš„åŒºé—´ï¼ŒLaplaceè¿‘ä¼¼æ•ˆæœä¸é”™ï¼Œå°¤å…¶çš„å…³äº $\hat x_\theta$ å¯¹ç§°çš„åŒºé—´ï¼Œç”±äºäºŒé˜¶è¿‘ä¼¼ç­‰äºä¸€é˜¶è¿‘ä¼¼ï¼Œä¸€é˜¶è¿‘ä¼¼çš„å€¼å·²ç»ç›¸å½“ç²¾ç¡®ã€‚ä½†æ˜¯å¯¹äºåç¦» $\hat x_\theta$ çš„åŒºé—´ï¼Œè¿‘ä¼¼çš„åå·®è¾ƒå¤§ï¼Œå¯¹äºå°¾æ¦‚ç‡çš„ä¼°è®¡æ›´æ˜¯éš¾ä»¥æ¥å—ã€‚ç›¸è¾ƒäºè´¹æ—¶çš„Monte Carloæ–¹æ³•ï¼Œå¿«æ·çš„Laplaceè¿‘ä¼¼å¯ä»¥çœ‹ä½œæœ€ç»ˆè§£å†³æ–¹æ¡ˆçš„ä¸€ä¸ªæŒ‡å¯¼ã€‚</p>

	

	

</article>




	<article>
	
		<h1><a href="/2018/11/05/ARS-Adaptive-Rejection-Sampling/">ARS (Adaptive Rejection Sampling)</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2018-11-05</span><br>
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/C/">C</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡/">ç»Ÿè®¡</a> <a class="article__tag-link" href="/tags/ç»Ÿè®¡è®¡ç®—/">ç»Ÿè®¡è®¡ç®—</a> <a class="article__tag-link" href="/tags/éšæœºæ•°äº§ç”Ÿ/">éšæœºæ•°äº§ç”Ÿ</a>
			</span>
		
	</div>

	

	
		<p>ARS (Adaptive Rejection Sampling) æ˜¯ä¸€ç§ç”Ÿæˆå…·æœ‰å¯¹æ•°å‡¹å¯†åº¦ (log-concave density)çš„éšæœºæ•°çš„æ–¹æ³•ï¼ŒARSä½¿ç”¨åŒ…å›´çš„æ¥å—æ‹’ç» (Envelope Accept-Reject) æ–¹æ³•ï¼Œè€ŒEnvelopeæ¥å—æ‹’ç»æ–¹æ³•æ˜¯ä¸€èˆ¬æ¥å—æ‹’ç»æ–¹æ³•çš„ä¸€ä¸ªå˜å½¢ï¼ˆæ”¹è¿›ï¼‰ã€‚</p>
<h2 id="Envelope-Accept-Reject"><a href="#Envelope-Accept-Reject" class="headerlink" title="Envelope Accept-Reject"></a>Envelope Accept-Reject</h2><p>å’Œæ™®é€šçš„æ¥å—æ‹’ç»æ–¹æ³•ç›¸æ¯”ï¼ŒEARå¤šäº†ä¸€ä¸ªä¸‹ç•Œï¼Œå³ï¼Œè‹¥å­˜åœ¨å¯†åº¦$g_m$ï¼Œå‡½æ•°$g_l$å’Œæ­£å¸¸æ•°$M$æ»¡è¶³<br>$$g_l(x) \leq f(x) \leq Mg_m(x),$$<br>åˆ™ä¸‹åˆ—ç®—æ³•äº§ç”Ÿéšæœºå˜é‡æœä»åˆ†å¸ƒ$f$</p>
<ol>
<li>ç”Ÿæˆ $X \sim g_m(x), U \sim \mathcal{U}_{[0,1]}$</li>
<li>IF  $U \leq g_l(X)/Mg_m(X)$</li>
<li>THEN æ¥å—$X$</li>
<li>ELSEIF  $U \leq f(X)/Mg_m(X)$</li>
<li>THEN æ¥å—$X$</li>
</ol>
<p>è¿™ä¸ªç®—æ³•çš„æˆç«‹æ˜¯æ˜¾ç„¶çš„ï¼Œè‹¥æœ‰$U \leq g_l(X)/Mg_m(X)$ï¼Œå¿…æœ‰$U \leq f(X)/Mg_m(X)$ï¼Œæ‰€ä»¥å’Œæ™®é€šçš„æ¥å—æ‹’ç»æ–¹æ³•ç›¸æ¯”ï¼ŒEARå¯èƒ½åœ¨ç¬¬3è¡Œå°±ç»“æŸï¼Œè€Œä¸ç”¨è®¡ç®—$f(x)$çš„å€¼ï¼Œè¿™ä¸ªä¼˜ç‚¹å½“$f(x)$å¾ˆéš¾è®¡ç®—æ—¶ä¾¿å¾ˆæœ‰ç”¨ã€‚</p>
<p>å½“ç„¶EARå¹¶ä¸èƒ½å®Œå…¨é¿å…è®¡ç®—$f(x)$çš„å€¼ï¼Œå…·ä½“æ¥è®²ï¼ŒèŠ‚çœçš„æ¯”ä¾‹ä¸º<br>$$\begin{align}<br>P(U \leq g_l(X)/Mg_m(x)) &amp;= E[P(U \leq g_l(X)/Mg_m(X) | X)] \\<br>                         &amp;= E[g_l(X)/Mg_m(X)] \\<br>                         &amp;= \frac{1}{M} \int{g_m(x)dx}<br>\end{align}$$</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸Šè¿°çš„å‡½æ•°$g_l, f, g_m$ï¼Œéƒ½å¯ä»¥ä¹‹å¤šå·®ä¸€ä¸ªç³»æ•°ï¼Œä½†æ˜¯è¿™æ ·çš„è¯ï¼Œå¸¸æ•°$M$ä¸å†å…·æœ‰ä¸Šè¿°çš„å«ä¹‰ã€‚ä»¥æ­£æ€åˆ†å¸ƒ$N(0,1)$ä¸ºä¾‹ï¼Œç•¥å»å¸¸æ•°ï¼Œå– $f(x)=\exp (-x^2/2)$ã€‚ç”±æ³°å‹’å…¬å¼ï¼Œ<br>$$e^{-x^2/2} \geq 1-\frac{x^2}{2}$$<br>äºæ˜¯å¯å–<br>$$g_l(x) = \left (1-\frac{x^2}{2} \right ) \lor 0$$<br>å¦ä¸€æ–¹é¢è‹¥å–$g_m(x)$ä¸ºLaplace(1)åˆ†å¸ƒï¼Œå³$g_m(x)=\lambda /2 \exp (-\lambda x), \lambda=1$ï¼Œåˆ™å®¹æ˜“è®¡ç®—æ¥å—ç‡ä¸º76%ï¼Œå¼•å…¥Envelopeä¸‹ç•Œï¼Œå¯é¿å…58%çš„$f(x)$çš„è®¡ç®—ï¼Œå¯¹äºå¤æ‚çš„ç›®æ ‡å¯†åº¦ï¼Œè¿™ä¸ªèŠ‚çœè¿˜æ˜¯å¾ˆå¯è§‚ã€‚</p>
<h2 id="Adaptive-Rejection-Sampling"><a href="#Adaptive-Rejection-Sampling" class="headerlink" title="Adaptive Rejection Sampling"></a>Adaptive Rejection Sampling</h2><p>è‡ªé€‚åº”æ‹’ç»é‡‡æ ·(ARS)çš„æƒ³æ³•å¾ˆç®€å•ï¼ŒåŸºäºä¸Šè¿°EARçš„æ€è·¯ï¼Œå¯¹äºå…·æœ‰å¯¹æ•°å‡¹å¯†åº¦çš„éšæœºå˜é‡ï¼Œç”±å‡¹å‡½æ•°çš„å‡ ä½•æ€§è´¨ï¼Œå¾ˆå®¹æ˜“æ„é€ å‡ºè‡ªé€‚åº”çš„Envelopeä¸Šä¸‹ç•Œï¼Œå‡†ç¡®æ¥è®²æ˜¯æ„é€ åˆ†æ®µçº¿æ€§å‡½æ•°çš„ä¸Šä¸‹ç•Œã€‚</p>
<p><figure class="figure"><img src="/img/ARS.svg" alt="å›¾ 1. ARSç®—æ³•"><figcaption class="figure__caption">å›¾ 1. ARSç®—æ³•</figcaption></figure></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè®¾ $h=\log f$ å‡¹ï¼Œ$S_n = \{x_i, i=0,1,â€¦,n+1\}$ æ˜¯ä¸€åˆ—ä»å°åˆ°å¤§çš„ $f$ æ”¯æ’‘ä¸Šçš„ç‚¹ã€‚ç”± $h$ çš„å‡¹æ€§ï¼Œç›´çº¿ $L_{i,i+1}$ ç©¿è¿‡ç‚¹ $(x_i,h(x_i))$ å’Œç‚¹ $(x_{i+1},h(x_{i+1}))$ï¼Œåœ¨åŒºé—´ $[x_i,x_{i+1}]$ ä¸Šåœ¨ $h$ çš„ä¸‹æ–¹ï¼Œåœ¨è¿™ä¸ªåŒºé—´å¤–åœ¨ $h$ çš„ä¸Šæ–¹ï¼Œäºæ˜¯æˆ‘ä»¬å®šä¹‰<br>$$ \overline{h}_n (x) = \min \{ L_{i-1,i}(x), L_{i+1,i+2}(x) \}$$</p>
<p>å¦‚ä¸Šå›¾çº¢çº¿ï¼Œå®šä¹‰<br>$$\underline{h}_n(x) = L_{i,i+1}(x)$$</p>
<p>å¦‚ä¸Šå›¾è“çº¿æ‰€ç¤ºã€‚åœ¨é›†åˆ $[ x_0,x_{n+1} ]^c$ ä¸Šè¡¥å……<br>$$\underline{h}_n(x) = - \infty, \quad \overline{h}_n (x) = \min \{ L_{0,1}(x), L_{n,n+1}(x)$$<br>è¿™æ ·ï¼Œåœ¨ $f$ çš„æ”¯æ’‘ä¸Šæˆç«‹<br>$$\underline{h}_n(x) \leq h(x) \leq \overline{h}_n (x)$$<br>æœ€åå–æŒ‡æ•°ï¼Œå³ $\underline{f}_n(x) = \exp \underline{h}_n(x)$ï¼Œ$\overline{f}_n(x) = \exp \overline{h}_n(x)$ï¼Œæœ‰<br>$$\underline{f}_n(x) \leq f(x) \leq \overline{f}_n (x)= \varpi g_n(x)$$<br>æœ€å³è¾¹çš„ç­‰å·è¡¨ç¤ºï¼Œå°† $\overline{f}_n(x)$ å½’ä¸€åŒ–ä¸ºå¯†åº¦å‡½æ•°ï¼Œ$\varpi$æ˜¯æ­£è§„åŒ–å¸¸æ•°ã€‚</p>
<p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†Envelopeçš„ä¸Šä¸‹ç•Œï¼Œå¸¦å…¥åˆ°EARç®—æ³•ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„ARSç®—æ³•</p>
<ol start="0">
<li>åˆå§‹åŒ– $n$ å’Œ $S_n$</li>
<li>ç”Ÿæˆ $X \sim g_n(x), U \sim \mathcal{U}_{[ 0,1 ]}$</li>
<li>IF $U \leq \underline{f}_n(X) / \varpi g_n(X)$</li>
<li>THEN æ¥å— $X$</li>
<li>ELSEIF $U \leq f(X) / \varpi g_n(X)$</li>
<li>THEN æ¥å— $X$</li>
<li>$\qquad$æ›´æ–° $S_n \to S_{n+1}=S_n \cup \{ X \}$</li>
</ol>
<p>ARSç®—æ³•åœ¨ç”Ÿæˆéšæœºæ•°è¿‡ç¨‹ä¸­ä¼šä¸æ–­æ›´æ–° $S_n$ï¼Œä½¿å¾—Envelopeä¸Šä¸‹ç•Œè¶Šæ¥è¶Šæ¥è¿‘ $f$ï¼Œç®—æ³•çš„æ•ˆç‡è¶Šæ¥è¶Šé«˜ï¼Œä½“ç°åœ¨æ¥å—ç‡è¶Šæ¥è¶Šæ¥è¿‘1,å’Œè®¡ç®— $f(x)$ çš„é¢‘ç‡è¶Šæ¥è¶Šå°‘ï¼ˆè¶‹è¿‘äº0ï¼‰ã€‚</p>
<p>å¦å¤–è¦æŒ‡å‡ºçš„æ˜¯ï¼Œç®—æ³•ä¸­çš„å¸¸æ•° $\varpi$ å¹¶ä¸ç”¨è®¡ç®—ï¼Œå› ä¸º $\varpi$ æ€»æ˜¯å’Œ $g_n(X)$ ä¸€èµ·ï¼Œè€Œ $\varpi g_n(X) = \overline{f}_n (x)$ã€‚</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼ŒARSç®—æ³•åªå·®çš„æ­¥éª¤1çš„ç”Ÿæˆ $X \sim g_n(X)$ï¼Œå®ƒè¢«è§£å†³å¦‚ä¸‹</p>
<h2 id="Generate-X-sim-g-n-x"><a href="#Generate-X-sim-g-n-x" class="headerlink" title="Generate $X \sim g_n(x)$"></a>Generate $X \sim g_n(x)$</h2><p>$g_n(x)$ æ˜¯åˆ†æ®µå‡½æ•°ï¼Œæˆ‘ä»¬å°†å®ƒé‡æ–°å†™æˆ<br>$$g_n(x) = \varpi^{-1} \left \{ \sum_{i=0}^{r_n} e^{\alpha_i x + \beta_i} \Bbb{I}_{[ x_i,x_{i+1} ]}(x) +<br>e^{\alpha_{-1} x + \beta_{-1}} \Bbb{I}_{[- \infty,x_0]}(x) +<br>e^{\alpha_{r_n+1} x + \beta_{r_n+1}} \Bbb{I}_{[x_n+1,+ \infty]}(x) \right \}$$</p>
<p>å…¶ä¸­ $y=\alpha_i x + \beta_i$ å¯¹åº”åŒºé—´ $[ x_i,x_i+1 ]$ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬ç›¸é‚»ä¸¤ä¸ªçº¿æ®µçš„äº¤ç‚¹ï¼Œç›´çº¿ $y=\alpha_i x + \beta_i$ å’Œ $y=\alpha_{i+1} x + \beta_{i+1}$ çš„äº¤ç‚¹åœ¨ $x=-(\beta_{i+1}-\beta_i)/(\alpha_{i+1}-\alpha_i)$ å¤„ã€‚$y=\alpha_{-1} x + \beta_{-1}$ å’Œ $y=\alpha_{r_n+1} x + \beta_{r_n+1}$ åˆ†åˆ«å¯¹åº”åŒºé—´ $[- \infty, x_0]$ å’Œ $ [ x_{n+1}, + \infty ]$ï¼Œ $r_n$ è¡¨ç¤ºçº¿æ®µçš„æ•°é‡</p>
<p>ç”± $\varpi g_n(X) = \overline{f}_n (x)$ï¼Œä¸¤è¾¹ç§¯åˆ†å¯å¾—<br>$$\begin{align} \varpi_n &amp;= \int_{- \infty}^{x_0} e^{\alpha_{-1} x + \beta_{-1}} dx +<br>\sum_{i=0}^{r_n} \int_{x_i}^{x_{i+1}} e^{\alpha_{i} x + \beta_{i+1}} dx +<br>\int_{x_{n+1}}^{+ \infty} e^{\alpha_{r_n+1} x + \beta_{r_n+1}} dx \\<br>&amp;= \frac{e^{\alpha_{-1} x_0 + \beta_{-1}}}{\alpha_{-1}} +<br>\sum_{i=0}^{r_n}  e^{\beta_i} \frac{\alpha_{i} x_{i+1} - \alpha_{i} x_{i}}{\alpha_{i}} -<br>\frac{\alpha_{r_n+1} x_{n+1}}{\alpha_{r_n+1}}<br>\end{align}$$</p>
<p>ç”±ä¸Šé¢çš„è®¡ç®—çŸ¥é“ï¼Œ$g_n(x)$ åœ¨åŒºé—´ $[ x_i,x_{i+1} ]$ ä¸Šçš„æ¦‚ç‡<br>$$\omega_i = \begin{cases}<br>\frac{e^{\alpha_{-1} x_0 + \beta_{-1}}}{ \varpi \alpha_{-1}} &amp;\text{if } i=-1, \\<br>e^{\beta_i} \frac{\alpha_{i} x_{i+1} - \alpha_{i} x_{i}}{\varpi \alpha_{i}} &amp;\text{if } 0 \leq i \leq r_n, \\<br>-\frac{\alpha_{r_n+1} x_{n+1}}{\varpi \alpha_{r_n+1}} &amp;\text{if } i = r_n+1.<br>\end{cases}$$</p>
<p>å…¶ä¸­ $ x_{-1}=- \infty, x_{r_n+2}=+ \infty$ã€‚åˆ©ç”¨é€†åˆ†å¸ƒåˆ†å¸ƒå‡½æ•°æ–¹æ³•ï¼Œæ³¨æ„åˆ°è‹¥ $ X \sim g_n(x)$ï¼Œåˆ™ $X|x_i \leq X \leq x_{i+1} \sim h(x)=c^{-1} \exp \{ \alpha_i x +\beta_i \} $ï¼Œå…¶ä¸­ $ c=\alpha^{-1} ( e^{\alpha_i x_{i+1} +\beta_i} -e^{\alpha_i x_{i} +\beta_i} )$ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹çš„ç®—æ³•ç”Ÿæˆéšæœºå˜é‡ $X \sim g_n(x)$</p>
<ol>
<li>ä¾æ¦‚ç‡ $\omega_i$ é€‰æ‹©åŒºé—´ $[ x_i,x_{i+1} ]$ </li>
<li>ç”Ÿæˆ $U \sim \mathcal{U}_{[ 0,1 ]}$ï¼Œå–<br>$$ X = \alpha^{-1} \log [ e^{\alpha_i x_i} + U (e^{\alpha_i x_{i+1}} - e^{\alpha_i x_i}) ]$$</li>
</ol>
<h2 id="ARSç®—æ³•çš„Cè¯­è¨€å®ç°"><a href="#ARSç®—æ³•çš„Cè¯­è¨€å®ç°" class="headerlink" title="ARSç®—æ³•çš„Cè¯­è¨€å®ç°"></a>ARSç®—æ³•çš„Cè¯­è¨€å®ç°</h2><p>åŸºäºä¸Šè¿°æè¿°ï¼Œæˆ‘ä»¬ç”¨Cè¯­è¨€å®ç°ARSç®—æ³•ï¼Œç”±äºç®—æ³•ä¸­æ¶‰åŠè®¸å¤šåŠ¨æ€åŠ¨æ€å†…å­˜çš„æ“ä½œï¼Œè€ƒè™‘åˆ°ç»“æ„åŒ–å’Œæ€§èƒ½çš„å¹³è¡¡ï¼Œæˆ‘ä»¬è®¾è®¡ç¨‹åºçš„ç»“æ„å¦‚ä¸‹ã€‚</p>
<p>é¦–å…ˆæ˜¯ä¿å­˜ä¸€ä¸ªçº¿æ®µçš„ç»“æ„ <code>Segment</code>ï¼ŒåŒ…å«çº¿æ®µçš„å§‹æœ«æ¨ªåæ ‡ï¼Œæ–œç‡ï¼Œæˆªè·å’Œå–å®ŒæŒ‡æ•°åçš„ç§¯åˆ†ã€‚<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">float</span> x1, x2;</span><br><span class="line">    <span class="keyword">float</span> alpha, beta;</span><br><span class="line">    <span class="keyword">float</span> area;</span><br><span class="line">&#125; Segment;</span><br></pre></td></tr></table></figure></p>
<p>ç»“æ„ä½“<code>Interval</code>ä¿å­˜äº†åŒºé—´ $[ x_i, x_{i+1} ]$ ä¸Šçš„envelopeä¸Šä¸‹ç•Œï¼ŒåŒ…å«ä¸‹ç•Œä¸€æ®µå’Œä¸Šç•Œï¼ˆè‡³å¤šï¼‰ä¸¤æ®µçº¿æ®µçš„ä¿¡æ¯ã€‚<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x1, x2;</span><br><span class="line">    <span class="keyword">double</span> alpha, beta;</span><br><span class="line">    Position flag;</span><br><span class="line">    Segment leftseg, rightseg;</span><br><span class="line">&#125; Interval;</span><br></pre></td></tr></table></figure></p>
<p>æœ€åæˆ‘ä»¬ä½¿ç”¨äºŒå‰æœç´¢æ ‘æ¥ç»„ç»‡è¿™äº›<code>Interval</code>ï¼ŒèŠ‚ç‚¹çš„åºå…³ç³»ç”±åŒºé—´çš„å‰åå®šä¹‰ã€‚äºŒå‰æ ‘çš„å®ç°ä½¿å¾—å¯¹åˆ†æ®µå‡½æ•°çš„æŸ¥æ‰¾å’Œæ±‚å€¼è¾¾åˆ° $O(\log n)$ çš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>ç”Ÿæˆéšæœºæ•°çš„å‡½æ•°<code>rars()</code>æ¥å—ä¸€ä¸ªæŒ‡å‘æ±‚å¯†åº¦å‡½æ•°å¯¹æ•°çš„å‡½æ•°æŒ‡é’ˆ<code>(*log_density)(double)</code> ï¼Œä¸åŒçš„å‡½æ•°æŒ‡é’ˆå¯ä»¥åŒ…è£…æˆä¸åŒçš„éšæœºæ•°å‡½æ•°ã€‚</p>
<p>ä¸‹é¢çš„æ˜¾ç¤ºäº†éƒ¨åˆ†æ ¸å¿ƒä»£ç ï¼Œå®Œæ•´çš„æºä»£ç å‚è§ <a href="https://github.com/vonweber0616/ARS" target="_blank" rel="noopener">GitHubä»“åº“</a>ã€‚</p>
<p>æœ€åå€¼å¾—ä¸€æçš„æ˜¯ARSçš„ç®—æ³•æˆ‘è§‰å¾—å”¯ä¸€çš„ä¼˜ç‚¹å°±æ˜¯æ³›ç”¨æ€§ï¼Œå› ä¸ºè®¸å¤šæœ‰ç”¨çš„åˆ†å¸ƒéƒ½æ˜¯å¯¹æ•°å‡¹å¯†åº¦ã€‚ARSç®—æ³•çœ‹èµ·æ¥å¾ˆç†æƒ³ï¼Œä½†æ˜¯åœ¨å®ç°ä¸Šçš„ç¼ºç‚¹æ˜¯å®ƒåŒ…å«å¤§é‡åŠ¨æ€å†…å­˜æ“ä½œï¼Œè¿™äº›å†…å­˜æ“ä½œçš„å¼€é”€å·²ç»è¿œè¶…è¿‡è®¡ç®—æœ¬èº«ï¼Œæ­¤å¤–ç”±äºARSç®—æ³•æ„é€ åˆ†æ®µçš„envelopeä¸Šä¸‹ç•Œï¼Œéšç€é›†åˆ $S_n$ ä¸æ–­å¢å¤§ï¼Œå¯¹åˆ†æ®µå‡½æ•°è¿›è¡Œæ±‚å€¼å¾—å¼€é”€ä¹Ÿè¶Šæ¥è¶Šå¤§ã€‚æ‰€ä»¥æˆ‘è§‰å¾—ä¸å¦‚ä¸€å¼€å§‹å°±è®¾å®šä¸€ä¸ªå……åˆ†å¤§çš„é›†åˆ $S_n$ï¼Œæ¯”å¦‚åŒ…å«å‡ ç™¾ä¸ªåˆ†å‰²ç‚¹ï¼Œæ— éœ€åœ¨ç”Ÿæˆéšæœºæ•°è¿‡ç¨‹ä¸­æ›´æ–° $S_n$ã€‚</p>
<script src="//gist.github.com/141a5cb0e9229491c07b3442ae5bd841.js?file=ARS.c"></script>

	

	

</article>





	<span class="different-posts">ğŸ“– <a href="/page/2">more posts</a> ğŸ“–</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>Hi there, <br>welcome to my Blog glad you found it. Have a look around, will you?</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>Â© 2018 von Weber | Powered by <a href="https://hexo.io/">Hexo</a> | Theme <a href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
